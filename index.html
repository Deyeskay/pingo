<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>P2P Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Home Screen -->
  <div id="home-screen" class="screen active">
    <h2>ğŸ§© Pingo 
      <button class="small-btn" onclick="switchMode()" title="Switch mode">ğŸ”</button>
    </h2>

    <p id="mode-msg"><strong>Loading...</strong></p>

    <div id="host-id-section" style="display: none;">
      <p><strong>Your ID:</strong> 
        <span id="my-id">Loading...</span> 
        <span class="copy-icons" onclick="copyID()">ğŸ“‹</span> 
        <span class="copy-icons" onclick="shareID()">ğŸ”—</span>
      </p>
    </div>

    <div id="joiner-id-section" style="display: none;">
      <input id="peer-id-input" placeholder="Enter host ID to join">
    </div>

    <input id="nickname" placeholder="Enter your name/nickname">

    <button id="join-btn" onclick="connectToHost()">Join Room</button>
    <button id="go-to-chat" onclick="validateAndGoToChat()" style="display: none;">Go to Chat Room</button>
  </div>

  <!-- Chat Screen -->
  <div id="chat-screen" class="screen">
    <div id="top-bar">
      <h2>ğŸ§© Pingo</h2>
      <div class="toolbar-icons">
        <div id="people-icon-container" style="position: relative; cursor: pointer;" onclick="showPeopleModal()">
          <span style="font-size: 1.3em;">ğŸ‘¥</span>
          <span id="participant-badge" class="badge" style="display:none;">1</span>
        </div>
        <button id="exit-room" onclick="exitRoom()">Exit Room</button>
      </div>
    </div>

    <div id="host-id-bar" style="margin-bottom: 10px; display: none;">
      <strong>ID:</strong>
      <span class="copy-icons" onclick="copyID()">ğŸ“‹</span>
      <span class="copy-icons" onclick="shareID()">ğŸ”—</span>
    </div>

    <div id="chat-box"></div>
    <input id="message" placeholder="Enter message">
    <button onclick="sendMessage()">Send</button>
  </div>

  <!-- Participants Modal -->
  <div class="modal-bg" id="modal-bg"></div>
  <div id="people-modal">
    <h3>ğŸ‘¥ Participants</h3>
    <p id="participant-count">Total: 0</p>
    <ul id="people-list"></ul>
    <button onclick="hidePeopleModal()">Close</button>
  </div>

  <!-- PeerJS -->
  <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <script src="rtcpeer.js"></script>
  <script>
  document.getElementById("message").addEventListener("keydown", function(e) {
    if (e.key === "Enter") sendMessage();
  });
</script>

</body>
</html>
